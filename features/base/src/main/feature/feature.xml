<?xml version="1.0" encoding="UTF-8"?>
<features name="${project.artifactId}-${project.version}" xmlns="http://karaf.apache.org/xmlns/features/v1.3.0">

  <!-- <feature name="${project.artifactId}" description="${project.name}" version="${project.version}"> -->

  <feature name="shk-web-test">
    <feature>shk-runtime</feature>
    <bundle>mvn:org.openhab.bundles.ui/org.openhab.ui.dashboard/2.0.0-SNAPSHOT</bundle>
    <feature>esh-ui-paper</feature>
  </feature>

  <feature name="shk-runtime" description="${project.name}" version="${project.version}">
    <details>${project.description}</details>
    <!-- As long as the Equinox framework is used, we could force them (but needs a repo first, ...) -->
    <!--<feature>shk-equinox-utils</feature>-->
    <feature>esh-base</feature>
    <feature>esh-io-console-karaf</feature>
    <feature>esh-io-rest-sitemap</feature>
    <feature>esh-model-item-runtime</feature>
    <feature>esh-model-persistence-runtime</feature>
    <feature>esh-model-rule-runtime</feature>
    <feature>esh-model-script-runtime</feature>
    <feature>esh-model-sitemap-runtime</feature>
    <feature>esh-model-thing-runtime</feature>
    <feature>esh-storage-mapdb</feature>
    <feature>esh-ui-iconset-classic</feature>
    <feature>war</feature>
  </feature>

  <!--  <feature name="shk-equinox-utils" version="${project.version}">
    <bundle>mvn:de.maggu2810.playground/karaf-console-equinox/1.0.0</bundle>
  </feature>-->

  <feature name="shk-apache-httpclient" version="${dep.apache.httpcomponents.version}">
    <bundle>mvn:${dep.apache.httpcomponents.groupId}/${dep.apache.httpcomponents.httpcore.artifactId}/${dep.apache.httpcomponents.version}</bundle>
    <bundle>mvn:${dep.apache.httpcomponents.groupId}/${dep.apache.httpcomponents.httpclient.artifactId}/${dep.apache.httpcomponents.version}</bundle>
  </feature>

  <feature name="shk-jax-rs-min" version="5.2">
    <feature dependency="true">http</feature>
    <bundle dependency="true">mvn:com.eclipsesource.jaxrs/jersey-min/2.22.1</bundle>
    <bundle>mvn:com.eclipsesource.jaxrs/publisher/5.2</bundle>
  </feature>

  <feature name="shk-jax-rs-provider-gson" version="2.3">
    <feature dependency="true" version="[5.2,5.3)">shk-jax-rs-min</feature>
    <bundle dependency="true">mvn:com.google.code.gson/gson/2.3.1</bundle>
    <bundle>mvn:com.eclipsesource.jaxrs/provider-gson/2.3</bundle>
  </feature>

  <feature name="shk-jax-rs-provider-swagger" version="1.0.0-SNAPSHOT">
    <feature dependency="true" version="[5.2,5.3)">shk-jax-rs-min</feature>
    <bundle>mvn:de.maggu2810.playground.com.eclipsesource.jaxrs/swagger-all/1.5.4.sp2</bundle>
    <bundle>mvn:com.eclipsesource/com.eclipsesource.jaxrs.provider.swagger/1.0.0-SNAPSHOT</bundle>
  </feature>

  <feature name="shk-jmdns" version="${dep.jmdns.version}">
    <bundle>mvn:org.openhab.jmdns/jmdns/${dep.jmdns.version}</bundle>
    <capability>esh.tp;feature=jmdns</capability>
  </feature>

  <feature name="shk-jupnp" version="${dep.jupnp.version}">
    <feature dependency="true">http</feature>
    <feature>shk-apache-httpclient</feature>
    <bundle>mvn:org.jupnp/org.jupnp/${dep.jupnp.version}</bundle>
    <capability>esh.tp;feature=jupnp</capability>
  </feature>

  <feature name="shk-paho" version="${dep.paho.version}">
    <bundle>mvn:org.eclipse.paho/org.eclipse.paho.client.mqttv3/${dep.paho.version}</bundle>
    <capability>esh.tp;feature=paho</capability>
  </feature>

  <!-- All remaining (TODO: sort) Eclipse SmartHome bundles, create features for them -->
  <!--<bundle>mvn:org.eclipse.smarthome.automation/org.eclipse.smarthome.automation.sample-handler/${esh.version}</bundle>-->
  <!--<bundle dependency="true">mvn:org.eclipse.smarthome.core/org.eclipse.smarthome.core.extension.sample/${esh.version}</bundle>-->
  <!--<bundle dependency="true">mvn:org.eclipse.smarthome.io/org.eclipse.smarthome.io.console.eclipse/${esh.version}</bundle>-->
  <!--<bundle dependency="true">mvn:org.eclipse.smarthome.io/org.eclipse.smarthome.io.console.rfc147/${esh.version}</bundle>-->

  <feature name="shk-deps" version="${project.version}" description="Used to resolve dependencies only (see details).">
    <details>
      This is only used to provide optional dependencies to resolve features.
      There is no intention that this feature is installed manually or to provide some function on its own.
      Use this in other features with the dependency attribute set to true only.
      All bundles and features that are part of this one have to set the depencency attribute to true.
    </details>

    <feature dependency="true">shk-deps-commons</feature>
  </feature>

  <feature name="shk-deps-commons" version="${project.version}" description="Used to resolve dependencies only (see details).">
    <details>
      This is only used to provide optional dependencies to resolve features.
      There is no intention that this feature is installed manually or to provide some function on its own.
      Use this in other features with the dependency attribute set to true only.
      All bundles and features that are part of this one have to set the depencency attribute to true.
    </details>

    <bundle dependency="true">mvn:${dep.apache.commons.codec.groupId}/${dep.apache.commons.codec.artifactId}/${dep.apache.commons.codec.version}</bundle>
    <bundle dependency="true">mvn:${dep.apache.commons.collections.groupId}/${dep.apache.commons.collections.artifactId}/${dep.apache.commons.collections.version}</bundle>
    <bundle dependency="true">mvn:${dep.apache.commons.exec.groupId}/${dep.apache.commons.exec.artifactId}/${dep.apache.commons.exec.version}</bundle>
    <bundle dependency="true">mvn:${dep.apache.commons.httpclient.groupId}/${dep.apache.commons.httpclient.artifactId}/${dep.apache.commons.httpclient.version}</bundle>
    <bundle dependency="true">mvn:${dep.apache.commons.io.groupId}/${dep.apache.commons.io.artifactId}/${dep.apache.commons.io.version}</bundle>
    <bundle dependency="true">mvn:${dep.apache.commons.lang.groupId}/${dep.apache.commons.lang.artifactId}/${dep.apache.commons.lang.version}</bundle>
    <bundle dependency="true">mvn:${dep.apache.commons.net.groupId}/${dep.apache.commons.net.artifactId}/${dep.apache.commons.net.version}</bundle>
  </feature>

  <feature name="shk-deps-xtext-common" version="${esh.version}" description="Used to resolve Xtext dependencies only (see details).">
    <details>
      This is only used to provide optional dependencies to resolve features that needs Xtext or related stuff.
      There is no intention that this feature is installed manually or to provide some function on its own.
      Use this in other features with the dependency attribute set to true only.
      All bundles and features that are part of this one have to set the depencency attribute to true.
    </details>

    <!-- All bundles defined here are used by ALL our Xtext bundles -->
    <bundle dependency="true">mvn:${shk.groupId}.p2fetch/org.eclipse.equinox.common-3.7.0.v20150402-1709/${project.version}</bundle>
    <bundle dependency="true">mvn:${shk.groupId}.p2fetch/org.eclipse.equinox.registry-3.6.0.v20150318-1503/${project.version}</bundle>
    <bundle dependency="true">mvn:${shk.groupId}.p2fetch/org.eclipse.equinox.supplement-1.6.0.v20141009-1504/${project.version}</bundle>
    <bundle dependency="true">mvn:${shk.groupId}.p2fetch/com.google.guava-10.0.1.v201203051515/${project.version}</bundle>
    <bundle dependency="true">mvn:${shk.groupId}.p2fetch/com.google.inject-3.0.0.v201312141243/${project.version}</bundle>
    <bundle dependency="true">mvn:${shk.groupId}.p2fetch/org.antlr.runtime-3.2.0.v201101311130/${project.version}</bundle>
    <bundle dependency="true">mvn:${shk.groupId}.p2fetch/org.objectweb.asm-5.0.1.v201404251740/${project.version}</bundle>
  </feature>

  <feature name="shk-deps-xtext-special" version="2.6.2" description="Used to resolve Xtext dependencies only (see details).">
    <details>
      This is only used to provide optional dependencies to resolve features that needs Xtext or related stuff.
      There is no intention that this feature is installed manually or to provide some function on its own.
      Use this in other features with the dependency attribute set to true only.
      All bundles and features that are part of this one have to set the depencency attribute to true.
    </details>
    <feature dependency="true">shk-deps-xtext-common</feature>
    <bundle dependency="true">mvn:${shk.groupId}.p2fetch/org.eclipse.emf.common-2.10.1.v20150123-0348/${project.version}</bundle>
    <bundle dependency="true">mvn:${shk.groupId}.p2fetch/org.eclipse.emf.ecore-2.10.2.v20150123-0348/${project.version}</bundle>
    <bundle dependency="true">mvn:${shk.groupId}.p2fetch/org.eclipse.emf.ecore.xmi-2.10.2.v20150123-0348/${project.version}</bundle>
    <bundle dependency="true">mvn:${shk.groupId}.p2fetch/org.eclipse.xtend.lib-2.6.2.v201407030533/${project.version}</bundle>
    <bundle dependency="true">mvn:${shk.groupId}.p2fetch/org.eclipse.xtext-2.6.2.v201407030533/${project.version}</bundle>
    <bundle dependency="true">mvn:${shk.groupId}.p2fetch/org.eclipse.xtext.common.types-2.6.2.v201407030533/${project.version}</bundle>
    <bundle dependency="true">mvn:${shk.groupId}.p2fetch/org.eclipse.xtext.util-2.6.2.v201407030533/${project.version}</bundle>
    <bundle dependency="true">mvn:${shk.groupId}.p2fetch/org.eclipse.xtext.xbase-2.6.2.v201407030533/${project.version}</bundle>
    <bundle dependency="true">mvn:${shk.groupId}.p2fetch/org.eclipse.xtext.xbase.lib-2.6.2.v201407030533/${project.version}</bundle>
    <capability>esh.tp;feature=xtext;version=2.6.2</capability>
  </feature>

  <!-- ESH target platform stuff (product specific) -->

  <feature name="esh-tp-base" description="TargetPlatform Base" version="${project.version}">
    <feature>eventadmin</feature>
    <feature>scr</feature>
    <feature>shk-jax-rs-min</feature>
    <feature>shk-jax-rs-provider-gson</feature>

    <!-- TODO: bundled in ESH io bundle -->
    <bundle dependency="true">mvn:io.swagger/swagger-annotations/1.5.4</bundle>
  </feature>

  <feature name="esh-tp-commons" version="${project.version}">
    <feature dependency="true">shk-deps-commons</feature>
  </feature>

  <feature name="esh-tp-jupnp" version="${project.version}">
    <feature>shk-jupnp</feature>
  </feature>

  <feature name="esh-tp-jmdns" version="${project.version}">
    <feature>shk-jmdns</feature>
  </feature>

  <feature name="esh-tp-paho" version="${project.version}">
    <feature>shk-paho</feature>
  </feature>

  <feature name="esh-tp-xtext" version="${project.version}">
    <feature version="[2.6.2,2.6.3)" dependency="true">shk-deps-xtext-special</feature>
  </feature>

</features>
