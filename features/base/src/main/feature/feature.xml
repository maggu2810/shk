<?xml version="1.0" encoding="UTF-8"?>
<features name="${project.artifactId}-${project.version}" xmlns="http://karaf.apache.org/xmlns/features/v1.3.0">

  <!-- <feature name="${project.artifactId}" description="${project.name}" version="${project.version}"> -->

  <feature name="shk-web-test">
    <feature>shk-runtime</feature>
    <bundle>mvn:org.openhab.bundles.ui/org.openhab.ui.dashboard/2.0.0-SNAPSHOT</bundle>
    <feature>shk-esh-ui-paper</feature>
  </feature>

  <feature name="shk-runtime" description="${project.name}" version="${project.version}">
    <details>${project.description}</details>
    <feature>shk-tp-base</feature>
    <!-- As long as the Equinox framework is used, we could force them (but needs a repo first, ...) -->
    <!--<feature>shk-equinox-utils</feature>-->
    <feature>shk-esh-base</feature>
    <feature>shk-esh-io-console-karaf</feature>
  </feature>

  <feature name="shk-tp-base" description="TargetPlatform Base" version="${project.version}">
    <feature>eventadmin</feature>
    <feature>scr</feature>
    <feature>war</feature>
    <feature>shk-jax-rs-min</feature>
    <feature>shk-jax-rs-provider-gson</feature>
  </feature>

  <feature name="shk-equinox-utils" version="${project.version}">
    <bundle>mvn:de.maggu2810.playground/karaf-console-equinox/1.0.0</bundle>
  </feature>

  <feature name="shk-esh-base" description="ESH" version="${project.version}">
    <details>ESH specific part</details>
    <feature>shk-tp-base</feature>

    <feature dependency="true">shk-deps</feature>
    <feature dependency="true">shk-deps-xtext</feature>
    <!-- ESH bundles -->
    <bundle>mvn:org.eclipse.smarthome.config/org.eclipse.smarthome.config.core/${esh.version}</bundle>
    <bundle>mvn:org.eclipse.smarthome.config/org.eclipse.smarthome.config.discovery/${esh.version}</bundle>
    <bundle>mvn:org.eclipse.smarthome.config/org.eclipse.smarthome.config.dispatch/${esh.version}</bundle>
    <bundle>mvn:org.eclipse.smarthome.config/org.eclipse.smarthome.config.xml/${esh.version}</bundle>
    <bundle>mvn:org.eclipse.smarthome.core/org.eclipse.smarthome.core/${esh.version}</bundle>
    <bundle>mvn:org.eclipse.smarthome.core/org.eclipse.smarthome.core.autoupdate/${esh.version}</bundle>
    <bundle>mvn:org.eclipse.smarthome.core/org.eclipse.smarthome.core.binding.xml/${esh.version}</bundle>
    <bundle>mvn:org.eclipse.smarthome.core/org.eclipse.smarthome.core.id/${esh.version}</bundle>
    <bundle>mvn:org.eclipse.smarthome.core/org.eclipse.smarthome.core.persistence/${esh.version}</bundle>
    <bundle>mvn:org.eclipse.smarthome.core/org.eclipse.smarthome.core.scheduler/${esh.version}</bundle>
    <bundle>mvn:org.eclipse.smarthome.core/org.eclipse.smarthome.core.thing/${esh.version}</bundle>
    <bundle>mvn:org.eclipse.smarthome.core/org.eclipse.smarthome.core.thing.xml/${esh.version}</bundle>
    <bundle>mvn:org.eclipse.smarthome.core/org.eclipse.smarthome.core.transform/${esh.version}</bundle>
    <bundle>mvn:org.eclipse.smarthome.io/org.eclipse.smarthome.io.console/${esh.version}</bundle>
    <bundle>mvn:org.eclipse.smarthome.io/org.eclipse.smarthome.io.monitor/${esh.version}</bundle>
    <bundle>mvn:org.eclipse.smarthome.io/org.eclipse.smarthome.io.multimedia/${esh.version}</bundle>
    <bundle>mvn:org.eclipse.smarthome.io/org.eclipse.smarthome.io.net/${esh.version}</bundle>
    <bundle>mvn:org.eclipse.smarthome.io/org.eclipse.smarthome.io.rest/${esh.version}</bundle>
    <bundle>mvn:org.eclipse.smarthome.io/org.eclipse.smarthome.io.rest.core/${esh.version}</bundle>
    <bundle>mvn:org.eclipse.smarthome.io/org.eclipse.smarthome.io.rest.sitemap/${esh.version}</bundle>
    <bundle>mvn:org.eclipse.smarthome.io/org.eclipse.smarthome.io.rest.sse/${esh.version}</bundle>
    <bundle>mvn:org.eclipse.smarthome.model/org.eclipse.smarthome.model.core/${esh.version}</bundle>
    <bundle>mvn:org.eclipse.smarthome.model/org.eclipse.smarthome.model.item/${esh.version}</bundle>
    <bundle>mvn:org.eclipse.smarthome.model/org.eclipse.smarthome.model.item.runtime/${esh.version}</bundle>
    <bundle>mvn:org.eclipse.smarthome.model/org.eclipse.smarthome.model.persistence/${esh.version}</bundle>
    <bundle>mvn:org.eclipse.smarthome.model/org.eclipse.smarthome.model.persistence.runtime/${esh.version}</bundle>
    <bundle>mvn:org.eclipse.smarthome.model/org.eclipse.smarthome.model.rule/${esh.version}</bundle>
    <bundle>mvn:org.eclipse.smarthome.model/org.eclipse.smarthome.model.rule.runtime/${esh.version}</bundle>
    <bundle>mvn:org.eclipse.smarthome.model/org.eclipse.smarthome.model.script/${esh.version}</bundle>
    <bundle>mvn:org.eclipse.smarthome.model/org.eclipse.smarthome.model.script.runtime/${esh.version}</bundle>
    <bundle>mvn:org.eclipse.smarthome.model/org.eclipse.smarthome.model.sitemap/${esh.version}</bundle>
    <bundle>mvn:org.eclipse.smarthome.model/org.eclipse.smarthome.model.sitemap.runtime/${esh.version}</bundle>
    <bundle>mvn:org.eclipse.smarthome.model/org.eclipse.smarthome.model.thing/${esh.version}</bundle>
    <bundle>mvn:org.eclipse.smarthome.model/org.eclipse.smarthome.model.thing.runtime/${esh.version}</bundle>
    <bundle>mvn:org.eclipse.smarthome.storage/org.eclipse.smarthome.storage.mapdb/${esh.version}</bundle>
    <bundle>mvn:org.eclipse.smarthome.transform/org.eclipse.smarthome.transform.exec/${esh.version}</bundle>
    <bundle>mvn:org.eclipse.smarthome.transform/org.eclipse.smarthome.transform.javascript/${esh.version}</bundle>
    <bundle>mvn:org.eclipse.smarthome.transform/org.eclipse.smarthome.transform.map/${esh.version}</bundle>
    <bundle>mvn:org.eclipse.smarthome.transform/org.eclipse.smarthome.transform.regex/${esh.version}</bundle>
    <bundle>mvn:org.eclipse.smarthome.transform/org.eclipse.smarthome.transform.xpath/${esh.version}</bundle>
    <bundle>mvn:org.eclipse.smarthome.transform/org.eclipse.smarthome.transform.xslt/${esh.version}</bundle>
    <bundle>mvn:org.eclipse.smarthome.ui/org.eclipse.smarthome.ui/${esh.version}</bundle>
    <bundle>mvn:org.eclipse.smarthome.ui/org.eclipse.smarthome.ui.icon/${esh.version}</bundle>
  </feature>

  <!-- All remaining (TODO: sort) Eclipse SmartHome bundles, create features for them -->
  <!--<bundle dependency="true">mvn:org.eclipse.smarthome.automation/org.eclipse.smarthome.automation.api/${esh.version}</bundle>-->
  <!--<bundle dependency="true">mvn:org.eclipse.smarthome.automation/org.eclipse.smarthome.automation.json/${esh.version}</bundle>-->
  <!--<bundle dependency="true">mvn:org.eclipse.smarthome.core/org.eclipse.smarthome.core.extension.sample/${esh.version}</bundle>-->
  <!--<bundle dependency="true">mvn:org.eclipse.smarthome.io/org.eclipse.smarthome.io.console.eclipse/${esh.version}</bundle>-->
  <!--<bundle dependency="true">mvn:org.eclipse.smarthome.io/org.eclipse.smarthome.io.console.rfc147/${esh.version}</bundle>-->
  <!--<bundle dependency="true">mvn:org.eclipse.smarthome.storage/org.eclipse.smarthome.storage.mapdb/${esh.version}</bundle>-->
  <!--<bundle dependency="true">mvn:org.eclipse.smarthome.transform/org.eclipse.smarthome.transform.jsonpath/${esh.version}</bundle>-->
  <!--<bundle dependency="true">mvn:org.eclipse.smarthome.transform/org.eclipse.smarthome.transform.scale/${esh.version}</bundle>-->
  <!--<bundle dependency="true">mvn:org.eclipse.smarthome.extension.ui.iconset/org.eclipse.smarthome.ui.iconset.classic/${esh.version}</bundle>-->

  <feature name="shk-deps" version="${project.version}" description="Used to resolve dependencies only (see details).">
    <details>
      This is only used to provide optional dependencies to resolve features.
      There is no intention that this feature is installed manually or to provide some function on its own.
      Use this in other features with the dependency attribute set to true only.
      All bundles and features that are part of this one have to set the depencency attribute to true.
    </details>

    <bundle dependency="true">mvn:${dep.apache.commons.codec.groupId}/${dep.apache.commons.codec.artifactId}/${dep.apache.commons.codec.version}</bundle>
    <bundle dependency="true">mvn:${dep.apache.commons.collections.groupId}/${dep.apache.commons.collections.artifactId}/${dep.apache.commons.collections.version}</bundle>
    <bundle dependency="true">mvn:${dep.apache.commons.exec.groupId}/${dep.apache.commons.exec.artifactId}/${dep.apache.commons.exec.version}</bundle>
    <bundle dependency="true">mvn:${dep.apache.commons.httpclient.groupId}/${dep.apache.commons.httpclient.artifactId}/${dep.apache.commons.httpclient.version}</bundle>
    <bundle dependency="true">mvn:${dep.apache.commons.io.groupId}/${dep.apache.commons.io.artifactId}/${dep.apache.commons.io.version}</bundle>
    <bundle dependency="true">mvn:${dep.apache.commons.lang.groupId}/${dep.apache.commons.lang.artifactId}/${dep.apache.commons.lang.version}</bundle>
    <bundle dependency="true">mvn:${dep.apache.commons.net.groupId}/${dep.apache.commons.net.artifactId}/${dep.apache.commons.net.version}</bundle>
  </feature>

  <feature name="shk-deps-xtext" version="${esh.version}" description="Used to resolve Xtext dependencies only (see details).">
    <details>
      This is only used to provide optional dependencies to resolve features that needs Xtext or related stuff.
      There is no intention that this feature is installed manually or to provide some function on its own.
      Use this in other features with the dependency attribute set to true only.
      All bundles and features that are part of this one have to set the depencency attribute to true.
    </details>

    <!-- All bundles defined here are used by ALL our Xtext bundles -->
    <bundle dependency="true">mvn:p2.osgi.bundle/org.eclipse.equinox.common/3.7.0.v20150402-1709</bundle>
    <bundle dependency="true">mvn:p2.osgi.bundle/org.eclipse.equinox.registry/3.6.0.v20150318-1503</bundle>
    <bundle dependency="true">mvn:p2.osgi.bundle/org.eclipse.equinox.supplement/1.6.0.v20141009-1504</bundle>
    <bundle dependency="true">mvn:p2.osgi.bundle/com.google.guava/10.0.1.v201203051515</bundle>
    <bundle dependency="true">mvn:p2.osgi.bundle/com.google.inject/3.0.0.v201312141243</bundle>
    <bundle dependency="true">mvn:p2.osgi.bundle/org.antlr.runtime/3.2.0.v201101311130</bundle>
    <bundle dependency="true">mvn:p2.osgi.bundle/org.objectweb.asm/5.0.1.v201404251740</bundle>

    <!-- Choose one Xtext version that should be used. -->
    <feature version="[2.6.2,2.6.3)" dependency="true">shk-deps-xtext-special</feature>
  </feature>

  <feature name="shk-deps-xtext-special" version="2.6.2" description="Used to resolve Xtext dependencies only (see details).">
    <details>
      This is only used to provide optional dependencies to resolve features that needs Xtext or related stuff.
      There is no intention that this feature is installed manually or to provide some function on its own.
      Use this in other features with the dependency attribute set to true only.
      All bundles and features that are part of this one have to set the depencency attribute to true.
    </details>

    <bundle dependency="true">mvn:p2.osgi.bundle/org.eclipse.emf.common/2.10.1.v20150123-0348</bundle>
    <bundle dependency="true">mvn:p2.osgi.bundle/org.eclipse.emf.ecore/2.10.2.v20150123-0348</bundle>
    <bundle dependency="true">mvn:p2.osgi.bundle/org.eclipse.emf.ecore.xmi/2.10.2.v20150123-0348</bundle>
    <bundle dependency="true">mvn:p2.osgi.bundle/org.eclipse.xtend.lib/2.6.2.v201407030533</bundle>
    <bundle dependency="true">mvn:p2.osgi.bundle/org.eclipse.xtext/2.6.2.v201407030533</bundle>
    <bundle dependency="true">mvn:p2.osgi.bundle/org.eclipse.xtext.common.types/2.6.2.v201407030533</bundle>
    <bundle dependency="true">mvn:p2.osgi.bundle/org.eclipse.xtext.util/2.6.2.v201407030533</bundle>
    <bundle dependency="true">mvn:p2.osgi.bundle/org.eclipse.xtext.xbase/2.6.2.v201407030533</bundle>
    <bundle dependency="true">mvn:p2.osgi.bundle/org.eclipse.xtext.xbase.lib/2.6.2.v201407030533</bundle>
  </feature>

  <!-- ESH bundles -->

  <feature name="shk-esh-binding-hue" version="${esh.version}">
    <feature>shk-esh-base</feature>
    <feature dependency="true">shk-deps</feature>
    <feature>shk-esh-io-transport-upnp</feature>
    <bundle>mvn:org.eclipse.smarthome.binding/org.eclipse.smarthome.binding.hue/${esh.version}</bundle>
  </feature>

  <feature name="shk-esh-binding-lifx" version="${esh.version}">
    <feature>shk-esh-base</feature>
    <feature dependency="true">shk-deps</feature>
    <bundle>mvn:org.eclipse.smarthome.binding/org.eclipse.smarthome.binding.lifx/${esh.version}</bundle>
  </feature>

  <feature name="shk-esh-binding-ntp" version="${esh.version}">
    <feature>shk-esh-base</feature>
    <feature dependency="true">shk-deps</feature>
    <bundle>mvn:org.eclipse.smarthome.binding/org.eclipse.smarthome.binding.ntp/${esh.version}</bundle>
  </feature>

  <feature name="shk-esh-binding-sonos" version="${esh.version}">
    <feature>shk-esh-base</feature>
    <feature dependency="true">shk-deps</feature>
    <feature>shk-esh-io-transport-upnp</feature>
    <bundle>mvn:org.eclipse.smarthome.binding/org.eclipse.smarthome.binding.sonos/${esh.version}</bundle>
  </feature>

  <feature name="shk-esh-binding-wemo" version="${esh.version}">
    <feature>shk-esh-base</feature>
    <feature dependency="true">shk-deps</feature>
    <bundle>mvn:org.eclipse.smarthome.binding/org.eclipse.smarthome.binding.wemo/${esh.version}</bundle>
  </feature>

  <feature name="shk-esh-binding-yahooweather" version="${esh.version}">
    <feature>shk-esh-base</feature>
    <feature dependency="true">shk-deps</feature>
    <bundle>mvn:org.eclipse.smarthome.binding/org.eclipse.smarthome.binding.yahooweather/${esh.version}</bundle>
  </feature>

  <feature name="shk-esh-io-console-karaf" description="Karaf Console support for SmartHome stuff" version="${esh.version}">
    <feature>shk-esh-base</feature>
    <feature dependency="true">shk-deps</feature>
    <feature>shell</feature>
    <bundle>mvn:org.eclipse.smarthome.io/org.eclipse.smarthome.io.console.karaf/${esh.version}</bundle>
  </feature>

  <feature name="shk-esh-io-transport-mdns" version="${esh.version}">
    <feature>shk-esh-base</feature>
    <feature dependency="true">shk-deps</feature>
    <feature>shk-jmdns</feature>
    <bundle>mvn:org.eclipse.smarthome.io/org.eclipse.smarthome.io.transport.mdns/${esh.version}</bundle>
  </feature>

  <feature name="shk-esh-io-transport-mqtt" version="${esh.version}">
    <feature>shk-esh-base</feature>
    <feature dependency="true">shk-deps</feature>
    <feature>shk-paho</feature>
    <bundle>mvn:org.eclipse.smarthome.io/org.eclipse.smarthome.io.transport.mqtt/${esh.version}</bundle>
  </feature>

  <feature name="shk-esh-io-transport-upnp" version="${esh.version}">
    <feature>shk-esh-base</feature>
    <feature dependency="true">shk-deps</feature>
    <feature>shk-jupnp</feature>
    <bundle>mvn:org.eclipse.smarthome.io/org.eclipse.smarthome.io.transport.upnp/${esh.version}</bundle>
  </feature>

  <feature name="shk-esh-ui-basic" version="${esh.version}">
    <feature>shk-esh-base</feature>
    <feature dependency="true">shk-deps</feature>
    <bundle>mvn:org.eclipse.smarthome.extension.ui/org.eclipse.smarthome.ui.basic/${esh.version}</bundle>
  </feature>

  <feature name="shk-esh-ui-classic" version="${esh.version}">
    <feature>shk-esh-base</feature>
    <feature dependency="true">shk-deps</feature>
    <bundle>mvn:org.eclipse.smarthome.extension.ui/org.eclipse.smarthome.ui.classic/${esh.version}</bundle>
  </feature>

  <feature name="shk-esh-ui-paper" version="${esh.version}">
    <feature>shk-esh-base</feature>
    <feature dependency="true">shk-deps</feature>
    <bundle>mvn:org.eclipse.smarthome.extension.ui/org.eclipse.smarthome.ui.paper/${esh.version}</bundle>
  </feature>

  <!-- other features -->

  <feature name="shk-apache-httpclient" version="${dep.apache.httpcomponents.version}">
    <bundle>mvn:${dep.apache.httpcomponents.groupId}/${dep.apache.httpcomponents.httpcore.artifactId}/${dep.apache.httpcomponents.version}</bundle>
    <bundle>mvn:${dep.apache.httpcomponents.groupId}/${dep.apache.httpcomponents.httpclient.artifactId}/${dep.apache.httpcomponents.version}</bundle>
  </feature>

  <feature name="shk-jax-rs-min" version="5.2">
    <feature dependency="true">http</feature>
    <bundle dependency="true">mvn:com.eclipsesource.jaxrs/jersey-min/2.22.1</bundle>
    <bundle>mvn:com.eclipsesource.jaxrs/publisher/5.2</bundle>
  </feature>

  <feature name="shk-jax-rs-provider-gson" version="2.3">
    <feature dependency="true" version="[5.2,5.3)">shk-jax-rs-min</feature>
    <bundle dependency="true">mvn:com.google.code.gson/gson/2.3.1</bundle>
    <bundle>mvn:com.eclipsesource.jaxrs/provider-gson/2.3</bundle>
  </feature>

  <feature name="shk-jax-rs-provider-swagger" version="1.0.0-SNAPSHOT">
    <feature dependency="true" version="[5.2,5.3)">shk-jax-rs-min</feature>
    <bundle>mvn:de.maggu2810.playground.com.eclipsesource.jaxrs/swagger-all/1.5.4.sp1</bundle>
    <bundle>mvn:com.eclipsesource/com.eclipsesource.jaxrs.provider.swagger/1.0.0-SNAPSHOT</bundle>
  </feature>

  <feature name="shk-jmdns" version="${dep.jmdns.version}">
    <bundle>mvn:org.openhab.jmdns/jmdns/${dep.jmdns.version}</bundle>
  </feature>

  <feature name="shk-jupnp" version="${dep.jupnp.version}">
    <feature dependency="true">http</feature>
    <feature>shk-apache-httpclient</feature>
    <bundle>mvn:org.jupnp/org.jupnp/${dep.jupnp.version}</bundle>
  </feature>

  <feature name="shk-paho" version="${dep.paho.version}">
    <bundle>mvn:org.eclipse.paho/org.eclipse.paho.client.mqttv3/${dep.paho.version}</bundle>
  </feature>

</features>
